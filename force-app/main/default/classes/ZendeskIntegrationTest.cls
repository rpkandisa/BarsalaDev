// Generated by Kandisa Technologies
@isTest
public class ZendeskIntegrationTest {
    static testMethod void validateZendeskIntegration() {

        test.startTest();

        List<Zendesk__c> lstzensettings = new List<Zendesk__c>();
        Zendesk__c zensettings = new Zendesk__c();
        zensettings.Name = 'commentJSONUrl';
        zensettings.Value__c = 'https://barsala.zendesk.com/api/v2/tickets/{0}/comments.json';
        lstzensettings.add(zensettings);

        zensettings = new Zendesk__c();
        zensettings.Name = 'username';
        zensettings.Value__c = 'rajesh@kandisatech.com';
        lstzensettings.add(zensettings);

        zensettings = new Zendesk__c();
        zensettings.Name = 'password';
        zensettings.Value__c = 'Barsala@123';
        lstzensettings.add(zensettings);

        insert lstzensettings;

        Zendesk__Zendesk_Ticket__c z = new Zendesk__Zendesk_Ticket__c();
        z.Name = '109139';
        insert z;

        String json = '{'+
    '    \"comments\": ['+
    '        {'+
    '            \"id\": 396307371973,'+
    '            \"type\": \"Comment\",'+
    '            \"author_id\": 7388632368,'+
    '            \"body\": \"Sean - Please process the refund for this and add screenshot to ticket showing complete.\\n\\nBill:\\n\\n\\\"Michael, two  individual lamps were damaged in shipping, not sure about the three still at office. I\'ll need to examine those, then consult with you regarding return/refund\\\"\",'+
    '            \"html_body\": \"<div class=\\\"zd-comment\\\">Sean - Please process the refund for this and add screenshot to ticket showing complete. <br><br>Bill: <br><br>\\\"Michael, two  individual lamps were damaged in shipping, not sure about the three still at office. I\'ll need to examine those, then consult with you regarding return/refund\\\"<br>\\n</div>\",'+
    '            \"plain_body\": \"Sean - Please process the refund for this and add screenshot to ticket showing complete. \\n\\nBill: \\n\\n\\\"Michael, two  individual lamps were damaged in shipping, not sure about the three still at office. I\'ll need to examine those, then consult with you regarding return/refund\\\"\",'+
    '            \"public\": true,'+
    '            \"attachments\": ['+
    '                {'+
    '                    \"url\": \"https://barsala.zendesk.com/api/v2/attachments/361048714373.json\",'+
    '                    \"id\": 361048714373,'+
    '                    \"file_name\": \"Screen Shot 2018-04-27 at 5.25.55 PM.png\",'+
    '                    \"content_url\": \"https://barsala.zendesk.com/attachments/token/yX7suHKPVHQlGVem1m7m8DEmM/?name=Screen+Shot+2018-04-27+at+5.25.55+PM.png\",'+
    '                    \"mapped_content_url\": \"https://barsala.zendesk.com/attachments/token/yX7suHKPVHQlGVem1m7m8DEmM/?name=Screen+Shot+2018-04-27+at+5.25.55+PM.png\",'+
    '                    \"content_type\": \"image/png\",'+
    '                    \"size\": 832912,'+
    '                    \"width\": 1026,'+
    '                    \"height\": 918,'+
    '                    \"inline\": false,'+
    '                    \"thumbnails\": ['+
    '                        {'+
    '                            \"url\": \"https://barsala.zendesk.com/api/v2/attachments/361048714393.json\",'+
    '                            \"id\": 361048714393,'+
    '                            \"file_name\": \"Screen_Shot_2018-04-27_at_5.25.55_PM_thumb.png\",'+
    '                            \"content_url\": \"https://barsala.zendesk.com/attachments/token/RdlTqS7MZTkoe9WNQYiO8xnBr/?name=Screen_Shot_2018-04-27_at_5.25.55_PM_thumb.png\",'+
    '                            \"mapped_content_url\": \"https://barsala.zendesk.com/attachments/token/RdlTqS7MZTkoe9WNQYiO8xnBr/?name=Screen_Shot_2018-04-27_at_5.25.55_PM_thumb.png\",'+
    '                            \"content_type\": \"image/png\",'+
    '                            \"size\": 6157,'+
    '                            \"width\": 80,'+
    '                            \"height\": 72,'+
    '                            \"inline\": false'+
    '                        }'+
    '                    ]'+
    '                }'+
    '            ],'+
    '            \"audit_id\": 396307371953,'+
    '            \"via\": {'+
    '                \"channel\": \"web\",'+
    '                \"source\": {'+
    '                    \"from\": {},'+
    '                    \"to\": {},'+
    '                    \"rel\": null'+
    '                }'+
    '            },'+
    '            \"created_at\": \"2018-04-28T00:27:27Z\",'+
    '            \"metadata\": {'+
    '                \"system\": {'+
    '                    \"client\": \"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_13_4) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/65.0.3325.181 Safari/537.36\",'+
    '                    \"ip_address\": \"209.63.143.172\",'+
    '                    \"location\": \"Seattle, WA, United States\",'+
    '                    \"latitude\": 47.63550000000001,'+
    '                    \"longitude\": -122.3235'+
    '                },'+
    '                \"custom\": {}'+
    '            }'+
    '        },'+
    '        {'+
    '            \"id\": 396321854313,'+
    '            \"type\": \"Comment\",'+
    '            \"author_id\": 7418491448,'+
    '            \"body\": \"Yes, they are repackaged for return.\\n\\nSean Edmunds\\n\\nGuest Logistics, Field Services Manager\\n\\nBarsala LLC\",'+
    '            \"html_body\": \"<div class=\\\"zd-comment\\\">Yes, they are repackaged for return.<br>\\n\\n<span class=\\\"collapse-signature\\\"></span><div class=\\\"signature\\\">\\n<p dir=\\\"auto\\\">Sean Edmunds</p>\\n<p dir=\\\"auto\\\">Guest Logistics, Field Services Manager</p>\\n<p dir=\\\"auto\\\">Barsala LLC</p>\\n</div>\\n</div>\",'+
    '            \"plain_body\": \"Yes, they are repackaged for return.\\n\\n\\n\\nSean Edmunds\\nGuest Logistics, Field Services Manager\\nBarsala LLC\",'+
    '            \"public\": true,'+
    '            \"attachments\": [],'+
    '            \"audit_id\": 396321854293,'+
    '            \"via\": {'+
    '                \"channel\": \"web\",'+
    '                \"source\": {'+
    '                    \"from\": {},'+
    '                    \"to\": {},'+
    '                    \"rel\": null'+
    '                }'+
    '            },'+
    '            \"created_at\": \"2018-04-28T02:02:25Z\",'+
    '            \"metadata\": {'+
    '                \"system\": {'+
    '                    \"client\": \"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_12_5) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/65.0.3325.181 Safari/537.36\",'+
    '                    \"ip_address\": \"98.247.242.178\",'+
    '                    \"location\": \"Seattle, WA, United States\",'+
    '                    \"latitude\": 47.6319,'+
    '                    \"longitude\": -122.29679999999999'+
    '                },'+
    '                \"custom\": {}'+
    '            }'+
    '        }'+
    '    ],'+
    '    \"next_page\": null,'+
    '    \"previous_page\": null,'+
    '    \"count\": 2'+
    '}';

        ZendeskIntegrationMockTest zmockd = new ZendeskIntegrationMockTest(200, 'Complete', json, null);
        Test.setMock(HttpCalloutMock.class, zmockd);

        ZendeskIntegration.callBatch();


        test.stopTest();  

    }
}